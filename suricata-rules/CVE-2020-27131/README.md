## Overview
CVE-2020-27131 allows attackers to exploit Java insecure deserialization on multiple endpoints of Cisco Security Manager. It leads to an unauthenticated remote code execution with the privileges of NT AUTHORITY\SYSTEM on the Windows target host.

There are 6 endpoints with different URLs. Some endpoints can be attacked directly via the HTTP request. The others require the victim to connect back to an RMI server before getting code execution. So, in these cases, the blue team can trace back to the C&C servers.

To fully detect this vulnerability on multiple endpoints, we need 3 Suricata rules. All are included in the rule file.

## Proof of Concept
* Exploit via **/CSCOnm/servlet/SecretService.jsp**
```
POST /CSCOnm/servlet/SecretService.jsp HTTP 1.1
Host: example.com
Content-Length: 2780
Content-Type: application/x-www-form-urlencoded

[serialized payload]
```

## References
* https://gist.github.com/Frycos/8bf5c125d720b3504b4f28a1126e509e
* https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-csm-java-rce-mWJEedcD